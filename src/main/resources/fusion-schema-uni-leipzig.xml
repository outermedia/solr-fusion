<?xml version="1.0" encoding="UTF-8"?>
<om:core xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:om="http://solrfusion.outermedia.org/configuration/"
         xmlns="http://solrfusion.outermedia.org/configuration/type/"
         xsi:schemaLocation="http://solrfusion.outermedia.org/configuration/ ../../main/resources/configuration.xsd ">

    <om:fusion-schema-fields default-type="text">
        <om:field name="recordtype"/>
        <om:field name="id"/>
        <om:field name="mrc0007"/>
        <om:field name="mrc0070"/>
        <om:field name="fullrecord"/>
        <om:field name="itemdata"/>
        <om:field name="marc_error" multi-value="true"/>
        <om:field name="allfields"/>
        <om:field name="allfields_unstemmed"/>
        <om:field name="fulltext" multi-value="false"/>
        <om:field name="spelling"/>
        <om:field name="spellingShingle" multi-value="true"/>
        <om:field name="mega_collection" multi-value="true"/>
        <om:field name="mega_toplevel" multi-value="true"/>
        <om:field name="record_id" multi-value="false"/>
        <om:field name="source_id" multi-value="false"/>
        <om:field name="authorized_mode" multi-value="false"/>
        <om:field name="institution" multi-value="true"/>
        <om:field name="signatur" multi-value="true"/>
        <om:field name="barcode" multi-value="true"/>
        <om:field name="rsn" multi-value="true"/>
        <om:field name="access_facet" multi-value="false"/>
        <om:field name="author_id" multi-value="true"/>
        <om:field name="topic_id" multi-value="true"/>
        <om:field name="author_ref" multi-value="true"/>
        <om:field name="author_corp_ref" multi-value="true"/>
        <om:field name="topic_ref" multi-value="true"/>
        <om:field name="multipart_set" multi-value="false"/>
        <om:field name="multipart_link" multi-value="true"/>
        <om:field name="multipart_part" multi-value="true"/>
        <om:field name="purchase" multi-value="true"/>
        <om:field name="timecode" multi-value="true"/>
        <om:field name="misc_dech1" multi-value="true"/>
        <om:field name="misc_del152" multi-value="true"/>
        <om:field name="misc_de105" multi-value="true"/>
        <om:field name="branch_de15" multi-value="true"/>
        <om:field name="branch_dech1" multi-value="true"/>
        <om:field name="branch_de105" multi-value="true"/>
        <om:field name="branch_de520" multi-value="true"/>
        <om:field name="branch_dezwi2" multi-value="true"/>
        <om:field name="branch_dezi4" multi-value="true"/>
        <om:field name="collcode_de15" multi-value="true"/>
        <om:field name="collcode_dech1" multi-value="true"/>
        <om:field name="collcode_de105" multi-value="true"/>
        <om:field name="collcode_de520" multi-value="true"/>
        <om:field name="collcode_dezwi2" multi-value="true"/>
        <om:field name="collcode_dezi4" multi-value="true"/>
        <om:field name="format_de15" multi-value="true"/>
        <om:field name="format_del152" multi-value="true"/>
        <om:field name="format_dech1" multi-value="true"/>
        <om:field name="format_de105" multi-value="true"/>
        <om:field name="format_de520" multi-value="true"/>
        <om:field name="format_del189" multi-value="true"/>
        <om:field name="format_dezwi2" multi-value="true"/>
        <om:field name="format_dezi4" multi-value="true"/>
        <om:field name="format_de540" multi-value="true"/>
        <om:field name="format_ded117" multi-value="true"/>
        <om:field name="local_heading_facet_del152" multi-value="true"/>
        <om:field name="local_heading_dezwi2" multi-value="true"/>
        <om:field name="local_heading_facet_dezwi2" multi-value="true"/>
        <om:field name="local_heading_del242" multi-value="true"/>
        <om:field name="local_class_del242" multi-value="true"/>
        <om:field name="udk_raw_de105" multi-value="true"/>
        <om:field name="udk_facet_de105" multi-value="true"/>
        <om:field name="udk_raw_del189" multi-value="true"/>
        <om:field name="finc_class_facet" multi-value="true"/>
        <om:field name="zdb" multi-value="false"/>
        <om:field name="format" multi-value="true"/>
        <om:field name="language" multi-value="true"/>
        <om:field name="author"/>
        <om:field name="author_orig" multi-value="false"/>
        <om:field name="authorStr"/>
        <om:field name="author2" multi-value="true"/>
        <om:field name="author2_orig" multi-value="true"/>
        <om:field name="author_corp"/>
        <om:field name="author_corp_orig" multi-value="false"/>
        <om:field name="author_corp2" multi-value="true"/>
        <om:field name="author_corp2_orig" multi-value="true"/>
        <om:field name="author2-role" multi-value="true"/>
        <om:field name="author_letter"/>
        <om:field name="author_facet" multi-value="true"/>
        <om:field name="author_browse" multi-value="true"/>
        <om:field name="title"/>
        <om:field name="title_part"/>
        <om:field name="title_sub"/>
        <om:field name="title_short"/>
        <om:field name="title_full"/>
        <om:field name="title_full_unstemmed"/>
        <om:field name="title_fullStr"/>
        <om:field name="title_alt" multi-value="true"/>
        <om:field name="title_uniform" multi-value="false"/>
        <om:field name="title_old" multi-value="true"/>
        <om:field name="title_new" multi-value="true"/>
        <om:field name="title_sort"/>
        <om:field name="title_orig" multi-value="false"/>
        <om:field name="series" multi-value="true"/>
        <om:field name="series2" multi-value="true"/>
        <om:field name="series_orig" multi-value="true"/>
        <om:field name="edition"/>
        <om:field name="publisher" multi-value="true"/>
        <om:field name="publishDate" multi-value="true"/>
        <!-- publishDateSort needs to be an int for year range query in vufinds extended search -->
        <om:field name="publishDateSort" type="int"/>
        <om:field name="imprint" multi-value="false"/>
        <om:field name="dateSpan" multi-value="true"/>
        <om:field name="publishPlace" multi-value="true"/>
        <om:field name="physical" multi-value="true"/>
        <om:field name="footnote" multi-value="true"/>
        <om:field name="dissertation_note" multi-value="true"/>
        <om:field name="performer_note" multi-value="true"/>
        <om:field name="illustrated" multi-value="false"/>
        <om:field name="contents" multi-value="true"/>
        <om:field name="url" multi-value="true"/>
        <om:field name="isbn" multi-value="true"/>
        <om:field name="issn" multi-value="true"/>
        <om:field name="isbn_canc" multi-value="true"/>
        <om:field name="ismn" multi-value="true"/>
        <om:field name="issn_canc" multi-value="true"/>
        <om:field name="oclc_num" type="long" multi-value="true"/>
        <om:field name="topic" multi-value="true"/>
        <om:field name="topic_unstemmed" multi-value="true"/>
        <om:field name="topic_facet" multi-value="true"/>
        <om:field name="geogr_code" multi-value="true"/>
        <om:field name="geogr_code_person" multi-value="true"/>
        <om:field name="music_heading" multi-value="true"/>
        <om:field name="music_heading_browse" multi-value="true"/>
        <om:field name="film_heading" multi-value="true"/>
        <om:field name="dewey-hundreds" multi-value="true"/>
        <om:field name="dewey-tens" multi-value="true"/>
        <om:field name="dewey-ones" multi-value="true"/>
        <om:field name="dewey-full" multi-value="true"/>
        <om:field name="dewey-sort"/>
        <om:field name="dewey-raw"/>
        <om:field name="rvk_facet" multi-value="true"/>
        <om:field name="rvk_label" multi-value="true"/>
        <om:field name="rvk_path" multi-value="true"/>
        <om:field name="attached_de15" type="date" multi-value="false"/>

        <om:field name="solr-server" />
        <om:field name="score" type="float"/>
    </om:fusion-schema-fields>

    <om:script-type name="javascript" class="org.outermedia.solrfusion.types.Js"/>
    <om:script-type name="beanshell" class="org.outermedia.solrfusion.types.Bsh"/>
    <om:script-type name="merge-multi-value" class="org.outermedia.solrfusion.types.MultiValueMerger"/>
    <om:script-type name="static-value" class="org.outermedia.solrfusion.types.Value"/>
    <om:script-type name="filter-id" class="org.outermedia.solrfusion.types.IdFilter"/>
    <om:script-type name="field-merger" class="org.outermedia.solrfusion.types.FieldMerger"/>
    <om:script-type name="normalizer" class="org.outermedia.solrfusion.types.Normalizer"/>
    <om:script-type name="set-doc-count" class="org.outermedia.solrfusion.types.SetFacetDocCount"/>
    <!-- Post Processors -->
    <om:script-type name="send-if-fq-eq" class="org.outermedia.solrfusion.types.FilterSpecificFq"/>
    <om:script-type name="filter-empty-fq" class="org.outermedia.solrfusion.types.FilterEmptyFq"/>

    <om:default-search-field>allfields</om:default-search-field>

    <om:default-sort-field>score desc</om:default-sort-field>

    <om:default-operator>AND</om:default-operator>

    <om:id-generator fusion-name="id"
                     class="org.outermedia.solrfusion.DefaultIdGenerator$Factory"/>

    <om:response-consolidator class="org.outermedia.solrfusion.response.PagingResponseConsolidator$Factory"/>

    <om:response-mapper class="org.outermedia.solrfusion.mapper.ResponseMapper$Factory" ignore-missing-mappings="true"/>

    <!-- The fusion query is transformed into a specific search server query -->
    <om:query-mapper class="org.outermedia.solrfusion.mapper.QueryMapper$Factory"/>

    <!-- This component controls the whole processing. -->
    <om:controller class="org.outermedia.solrfusion.FusionController$Factory"/>

    <!-- This component controls the whole processing of ids queries (javabin). -->
    <om:ids-controller class="org.outermedia.solrfusion.IdsFusionController$Factory" />

    <om:solr-servers>
        <om:timeout>4000</om:timeout>
        <om:disaster-limit>0</om:disaster-limit>
        <om:error key="disaster-limit">Please try later again.</om:error>
        <om:page-size>10</om:page-size>

        <om:query-parser
                class="org.outermedia.solrfusion.query.EdisMaxQueryParser$Factory"/>

        <om:dismax-query-parser
            class="org.outermedia.solrfusion.query.DisMaxQueryParser$Factory"/>

        <om:response-parser
                class="org.outermedia.solrfusion.response.DefaultResponseParser$Factory"/>

        <om:response-renderer type="xml"
                              class="org.outermedia.solrfusion.response.DefaultXmlResponseRenderer$Factory"/>

        <om:response-renderer type="json"
                              class="org.outermedia.solrfusion.response.DefaultJsonResponseRenderer$Factory"/>

        <om:response-renderer type="php"
                              class="org.outermedia.solrfusion.response.DefaultPhpResponseRenderer$Factory"/>

        <om:response-renderer type="javabin" class="org.outermedia.solrfusion.response.javabin.JavaBin4$Factory"/>

        <!-- edismax query builder -->
        <om:query-builder class="org.outermedia.solrfusion.mapper.QueryBuilder$Factory"/>

        <om:dismax-query-builder class="org.outermedia.solrfusion.mapper.DisMaxQueryBuilder$Factory"/>

        <om:merge fusion-name="isbn"
            class="org.outermedia.solrfusion.DefaultMergeStrategy$Factory">
            <om:target prio="1" target-name="UBL"/>
            <om:target prio="2" target-name="GBV"/>
            <om:target prio="3" target-name="DBoD1"/>
            <om:target prio="4" target-name="DBoD2"/>
            <om:target prio="5" target-name="UBL4"/>
        </om:merge>

        <om:solr-server name="UBL" version="3.5"
                        class="org.outermedia.solrfusion.adapter.solr.DefaultSolrAdapter$Factory">

            <om:url>http://findex.gbv.de:9000/solr/biblio/select/</om:url>

            <om:score factor="1.0"
                      class="org.outermedia.solrfusion.DefaultScore$Factory"/>

            <om:unique-key>id</om:unique-key>

            <om:max-docs>100</om:max-docs>

            <!-- keep all fields in general -->
            <om:field name="*" fusion-name="*" />

            <!-- but with the following exceptions -->
            <om:field name="id" fusion-name="id">
                <om:change>
                    <om:query type="filter-id" />
                </om:change>
            </om:field>
	        <!-- TODO dropped, because user is not logged in, is this OK? -->
            <om:field name="authorized_mode" fusion-name="authorized_mode">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <!-- normalize title sort field -->
            <om:field name="title_sort" fusion-name="title_sort">
                <om:change>
                    <om:response type="normalizer">
                        <trim>true</trim>
                        <to-lower-case>true</to-lower-case>
                        <start-chars-to-del>&#32;&#160;."-[(</start-chars-to-del>
                    </om:response>
                </om:change>
                <om:change><om:query /></om:change>
            </om:field>

            <om:field fusion-name="solr-server">
                <om:add>
                    <om:response target="facet" type="static-value">
                        <value>UBL</value>
                    </om:response>
                    <om:response target="facet" type="set-doc-count">
                        <total-found-nr />
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:post-processor>
                <om:query type="send-if-fq-eq">
                    <fusion-name>solr-server</fusion-name>
                    <fusion-value>UBL</fusion-value>
                </om:query>
                <om:query type="filter-empty-fq">
                    <ignore-fusion-name>solr-server</ignore-fusion-name>
                    <ignore-fusion-name>authorized_mode</ignore-fusion-name>
                </om:query>
            </om:post-processor>

        </om:solr-server>

        <om:solr-server name="GBV" version="3.6"
                        class="org.outermedia.solrfusion.adapter.solr.DefaultSolrAdapter$Factory">

            <om:url>http://findex.gbv.de:9001/index/ubl/select</om:url>

            <om:score factor="1.3515588925"
                      class="org.outermedia.solrfusion.DefaultScore$Factory"/>

            <om:unique-key>id</om:unique-key>

            <om:max-docs>100</om:max-docs>

            <om:field fusion-name="solr-server">
                <om:add>
                    <om:response target="facet" type="static-value">
                        <value>GBV</value>
                    </om:response>
                    <om:response target="facet" type="set-doc-count">
                        <total-found-nr />
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field name="format_facet" fusion-name="access_facet">
            </om:field>
            <om:field name="allfields" fusion-name="allfields">
            </om:field>
            <om:field name="allfields_unstemmed" fusion-name="allfields_unstemmed">
            </om:field>
            <om:field fusion-name="attached_de15">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="author" fusion-name="author">
            </om:field>
            <om:field name="author_browse" fusion-name="author_browse">
            </om:field>
            <om:field name="author2" fusion-name="author_corp">
                <om:add><om:response /></om:add>
            </om:field>
            <om:field name="author2" fusion-name="author_corp_orig">
                <om:add><om:response /></om:add>
            </om:field>
            <om:field fusion-name="author_corp_ref">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="author2" fusion-name="author_corp2">
                <om:add><om:response /></om:add>
            </om:field>
            <om:field name="author2" fusion-name="author_corp2_orig">
                <om:add><om:response /></om:add>
            </om:field>

            <!-- split-merge case author_facet -->
            <om:field name="author" fusion-name="author_facet">
                <om:add level="inside"><om:query /></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="author2" fusion-name="author_facet">
                <om:add level="inside"><om:query /></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="author_facet">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>author</field>
                        <field>author2</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field fusion-name="author_id">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="author-letter" fusion-name="author_letter">
            </om:field>
            <om:field name="author" fusion-name="author_orig">
                <om:add><om:response /></om:add>
            </om:field>
            <om:field fusion-name="author_ref">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="author2" fusion-name="author2">
            </om:field>
            <om:field name="author2" fusion-name="author2_orig">
                <om:add><om:response /></om:add>
            </om:field>
            <om:field name="author2-role" fusion-name="author2-role">
            </om:field>
            <om:field fusion-name="authorized_mode">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="authorStr" fusion-name="authorStr" />
            <om:field fusion-name="barcode">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="branch_de*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="collcode_de*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="contents">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="dateSpan">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="dewey-full" fusion-name="dewey-full">
            </om:field>
            <om:field name="dewey-hundreds" fusion-name="dewey-hundreds">
            </om:field>
            <om:field name="dewey-ones" fusion-name="dewey-ones">
            </om:field>
            <om:field name="dewey-raw" fusion-name="dewey-raw">
            </om:field>
            <om:field name="dewey-sort" fusion-name="dewey-sort">
            </om:field>
            <om:field name="dewey-tens" fusion-name="dewey-tens">
            </om:field>
            <om:field fusion-name="dissertation_note">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="edition">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="film_heading">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <!-- TODO table mapping necessary for finc_class_facet? -->
            <om:field name="dewey-tens" fusion-name="finc_class_facet">
            </om:field>
            <om:field fusion-name="footnote">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="format_facet" fusion-name="format">
                <om:add>
                    <om:response />
                </om:add>
            </om:field>
            <om:field fusion-name="format_de105">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="format_facet" fusion-name="format_de15">
            </om:field>
            <om:field fusion-name="format_de*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="fullrecord" fusion-name="fullrecord">
            </om:field>
            <om:field fusion-name="fulltext">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="geogr_code">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="geogr_code_person">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="id" fusion-name="id">
                <om:change>
                    <om:query type="filter-id" />
                </om:change>
            </om:field>
            <om:field fusion-name="illustrated">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="imprint">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="isbn" fusion-name="isbn">
            </om:field>
            <om:field name="isbn" fusion-name="isbn_canc">
                <om:add><om:response /></om:add>
            </om:field>
            <om:field fusion-name="ismn">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="issn" fusion-name="issn">
            </om:field>
            <om:field name="issn" fusion-name="issn_canc">
                <om:add><om:response /></om:add>
            </om:field>
            <om:field fusion-name="itemdata">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="language" fusion-name="language">
            </om:field>
            <om:field fusion-name="local*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="marc_error">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="collection_details" fusion-name="institution">
            </om:field>
            <om:field fusion-name="mega_toplevel">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="misc*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="mrc0007">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="mrc0070">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="multipart*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="music_heading">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="music_heading_browse">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="oclc_num">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="performer_note">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="physical" fusion-name="physical">
            </om:field>
            <om:field name="publishDate" fusion-name="publishDate">
            </om:field>
            <om:field name="publishDateSort" fusion-name="publishDateSort">
            </om:field>
            <om:field name="publisher" fusion-name="publisher">
            </om:field>
            <om:field name="publishPlace" fusion-name="publishPlace">
            </om:field>
            <om:field fusion-name="purchase">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="id" fusion-name="record_id">
            </om:field>
            <om:field name="recordtype" fusion-name="recordtype">
            </om:field>
            <om:field fusion-name="rsn">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="rvk*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="series" fusion-name="series">
            </om:field>
            <om:field fusion-name="series_orig">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="series2" fusion-name="series2">
            </om:field>
            <om:field name="signature" fusion-name="signatur">
            </om:field>
            <om:field name="source_id" fusion-name="source_id">
                <om:add>
                    <om:response type="static-value">
			            <value>37</value>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field name="spelling" fusion-name="spelling">
            </om:field>
            <om:field name="spellingShingle" fusion-name="spellingShingle">
            </om:field>
            <om:field fusion-name="timecode">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="title_auth" fusion-name="title">
            </om:field>
            <om:field name="title_alt" fusion-name="title_alt">
            </om:field>
            <om:field name="title_full" fusion-name="title_full">
            </om:field>
            <om:field fusion-name="title_full_unstemmed">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="title_fullStr">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="title_new" fusion-name="title_new">
            </om:field>
            <om:field name="title_old" fusion-name="title_old">
            </om:field>
            <om:field fusion-name="title_orig">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="title_part">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="title_short" fusion-name="title_short">
            </om:field>
            <om:field name="title_sort" fusion-name="title_sort">
                <om:change>
                    <om:response type="normalizer">
                        <trim>true</trim>
                        <to-lower-case>true</to-lower-case>
                        <start-chars-to-del>&#32;&#160;."-[(</start-chars-to-del>
                    </om:response>
                </om:change>
                <om:change><om:query /></om:change>
            </om:field>
            <om:field name="title_sub" fusion-name="title_sub">
            </om:field>
            <om:field fusion-name="title_uniform">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="topic" fusion-name="topic">
            </om:field>
            <om:field name="topic_facet" fusion-name="topic_facet">
            </om:field>
            <om:field fusion-name="topic_id">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="topic_ref">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="topic_unstemmed">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field fusion-name="udk*">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <om:field name="url" fusion-name="url">
            </om:field>
            <om:field fusion-name="zdb">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>

            <!-- vufind uses the following fields in a simple search, which don't exist in GBV -->
            <om:field fusion-name="mega_collection">
                <om:drop><om:query/></om:drop>
            </om:field>

            <om:post-processor>
                <om:query type="send-if-fq-eq">
                    <fusion-name>solr-server</fusion-name>
                    <fusion-value>GBV</fusion-value>
                </om:query>
                <om:query type="filter-empty-fq">
                    <ignore-fusion-name>solr-server</ignore-fusion-name>
                    <ignore-fusion-name>authorized_mode</ignore-fusion-name>
                </om:query>
            </om:post-processor>

        </om:solr-server>


        <om:solr-server name="DBoD1" version="3.6" query-param-name="q.alt" enabled="true"
                        class="org.outermedia.solrfusion.adapter.solr.Solr1Adapter$Factory">

            <om:url>http://findex.gbv.de:9002/te/select</om:url>

            <om:score factor="2.9744758135"
                      class="org.outermedia.solrfusion.DefaultScore$Factory"/>

            <!-- we use q.alt instead of q which supports the edismax query syntax
            <om:query-builder class="org.outermedia.solrfusion.mapper.DisMaxQueryBuilder$Factory" />
            -->

            <om:unique-key>id</om:unique-key>

            <om:max-docs>100</om:max-docs>

            <om:field fusion-name="solr-server">
                <om:add>
                    <om:response target="facet" type="static-value">
                        <value>DBoD1</value>
                    </om:response>
                    <om:response target="facet" type="set-doc-count">
                        <total-found-nr />
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field name="id" fusion-name="id">
                <om:change>
                    <om:query type="filter-id" />
                </om:change>
            </om:field>
            <om:field name="dbName" fusion-name="mega_collection"/>

            <!-- merge/split allfields -->
            <om:field name="content" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="dbName" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="description" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="edition" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="keywords" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="publisher" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="subjects" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_de" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="allfields">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>content</field>
                        <field>dbName</field>
                        <field>description</field>
                        <field>edition</field>
                        <field>keywords</field>
                        <field>publisher</field>
                        <field>subjects</field>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field name="subjects" fusion-name="finc_class_facet" />

            <!-- split/merge fulltext -->
            <om:field name="content" fusion-name="fulltext">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="description" fusion-name="fulltext">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="fulltext">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>content</field>
                        <field>description</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field name="permission" fusion-name="institution" />

            <!-- publishDateSort is used for sorting -->
            <!-- this is not a split/merge case -->
            <om:field name="edition" fusion-name="publishDateSort" >
            </om:field>
            <om:field name="edition" fusion-name="publishDate" >
            </om:field>

            <om:field name="publisher" fusion-name="publisher" />

            <!-- split/merge title -->
            <om:field name="titleVT_de" fusion-name="title">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="title">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="title">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <!-- vufind uses title_short to display titles, but DBoD has no title_short values -->
            <!-- split/merge title_short -->
            <om:field name="titleVT_de" fusion-name="title_short">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="title_short">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="title_short">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <!-- vufind uses title_sort to sort books, but DBoD has no title_sort values -->
            <!-- split/merge title_sort -->
            <om:field name="titleVT_de" fusion-name="title_sort">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="title_sort">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="title_sort">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                    <om:response type="normalizer">
                        <trim>true</trim>
                        <to-lower-case>true</to-lower-case>
                        <start-chars-to-del>&#32;&#160;."-[(</start-chars-to-del>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <!-- vufind uses the following fields in a simple search, which don't exist in DBoD -->
            <om:field fusion-name="format*">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="access_facet">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="mega_toplevel">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="branch_de15">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="language">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="author_facet">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="collcode_de15">
                <om:drop><om:query/></om:drop>
            </om:field>
            <om:field fusion-name="isbn">
                <om:drop><om:query/></om:drop>
            </om:field>

            <om:field name="keywords" fusion-name="topic" />

            <om:field name="deeplink" fusion-name="url" />

            <!--
            <om:field name="sourceid" fusion-name="record_id" />
            -->
            <om:field name="source_id" fusion-name="source_id">
                <om:add>
                    <om:response type="static-value">
                        <value>38</value>
                    </om:response>
                </om:add>
            </om:field>

            <om:post-processor>
                <om:query type="send-if-fq-eq">
                    <fusion-name>solr-server</fusion-name>
                    <fusion-value>DBoD1</fusion-value>
                </om:query>
                <om:query type="filter-empty-fq">
                    <ignore-fusion-name>solr-server</ignore-fusion-name>
                    <ignore-fusion-name>authorized_mode</ignore-fusion-name>
                </om:query>
            </om:post-processor>

        </om:solr-server>

        <!-- same mapping of DBoD1 except static source_id -->
        <om:solr-server name="DBoD2" version="1.4" query-param-name="q.alt"
                        class="org.outermedia.solrfusion.adapter.solr.Solr1Adapter$Factory">

            <om:url>http://findex.gbv.de:9003/solr/select</om:url>

            <om:score factor="2.9744758135"
                      class="org.outermedia.solrfusion.DefaultScore$Factory"/>

            <om:unique-key>id</om:unique-key>

            <om:max-docs>100</om:max-docs>

            <om:field fusion-name="solr-server">
                <om:add>
                    <om:response target="facet" type="static-value">
                        <value>DBoD2</value>
                    </om:response>
                    <om:response target="facet" type="set-doc-count">
                        <total-found-nr />
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field name="id" fusion-name="id">
                <om:change>
                    <om:query type="filter-id" />
                </om:change>
            </om:field>

            <om:field name="dbName" fusion-name="mega_collection"/>

            <!-- merge/split allfields -->
            <om:field name="content" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="dbName" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="description" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="edition" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="keywords" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="publisher" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="subjects" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_de" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="allfields">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="allfields">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>content</field>
                        <field>dbName</field>
                        <field>description</field>
                        <field>edition</field>
                        <field>keywords</field>
                        <field>publisher</field>
                        <field>subjects</field>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field name="subjects" fusion-name="finc_class_facet" />

            <!-- split/merge fulltext -->
            <om:field name="content" fusion-name="fulltext">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="description" fusion-name="fulltext">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="fulltext">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>content</field>
                        <field>description</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:field name="permission" fusion-name="institution" />

            <!-- publishDateSort is used for sorting -->
            <!-- this is not a split/merge case -->
            <om:field name="edition" fusion-name="publishDateSort" >
            </om:field>
            <om:field name="edition" fusion-name="publishDate" >
            </om:field>

            <om:field name="publisher" fusion-name="publisher" />

            <!-- split/merge title -->
            <om:field name="titleVT_de" fusion-name="title">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="title">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="title">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <!-- vufind uses title_short to display titles, but DBoD has no title_short values -->
            <!-- split/merge title_short -->
            <om:field name="titleVT_de" fusion-name="title_short">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="title_short">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="title_short">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <!-- vufind uses title_sort to sort books, but DBoD has no title_sort values -->
            <!-- split/merge title_sort -->
            <om:field name="titleVT_de" fusion-name="title_sort">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field name="titleVT_eng" fusion-name="title_sort">
                <om:add level="inside"><om:query/></om:add>
                <om:drop><om:response /></om:drop>
            </om:field>
            <om:field fusion-name="title_sort">
                <om:add>
                    <om:response type="field-merger">
                        <separator>;</separator>
                        <field>titleVT_de</field>
                        <field>titleVT_eng</field>
                    </om:response>
                    <om:response type="normalizer">
                        <trim>true</trim>
                        <to-lower-case>true</to-lower-case>
                        <start-chars-to-del>&#32;&#160;."-[(</start-chars-to-del>
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <!-- vufind uses the following fields in a simple search, which don't exist in DBoD -->
            <om:field fusion-name="format*">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="access_facet">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="mega_toplevel">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="branch_de15">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="language">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="author_facet">
                <om:drop><om:query /></om:drop>
            </om:field>
            <om:field fusion-name="collcode_de15">
                <om:drop><om:query/></om:drop>
            </om:field>
            <om:field fusion-name="isbn">
                <om:drop><om:query/></om:drop>
            </om:field>

            <om:field name="keywords" fusion-name="topic" />

            <om:field name="deeplink" fusion-name="url" />

            <om:field name="source_id" fusion-name="source_id">
                <om:add>
                    <om:response type="static-value">
                        <value>45</value>
                    </om:response>
                </om:add>
            </om:field>

            <om:post-processor>
                <om:query type="send-if-fq-eq">
                    <fusion-name>solr-server</fusion-name>
                    <fusion-value>DBoD2</fusion-value>
                </om:query>
                <om:query type="filter-empty-fq">
                    <ignore-fusion-name>solr-server</ignore-fusion-name>
                    <ignore-fusion-name>authorized_mode</ignore-fusion-name>
                </om:query>
            </om:post-processor>

        </om:solr-server>

        <om:solr-server name="UBL4" version="4.3"
            class="org.outermedia.solrfusion.adapter.solr.DefaultSolrAdapter$Factory">

            <om:url>http://findex.gbv.de:9005/solr/biblio/select</om:url>

            <om:score factor="1.0"
                class="org.outermedia.solrfusion.DefaultScore$Factory"/>

            <om:unique-key>id</om:unique-key>

            <om:max-docs>100</om:max-docs>

            <!-- keep all fields in general -->
            <om:field name="*" fusion-name="*" />

            <!-- but with the following exceptions -->
            <om:field name="id" fusion-name="id">
                <om:change>
                    <om:query type="filter-id" />
                </om:change>
            </om:field>
            <!-- TODO dropped, because user is not logged in, is this OK? -->
            <om:field name="authorized_mode" fusion-name="authorized_mode">
                <om:drop>
                    <om:query/>
                </om:drop>
            </om:field>
            <!-- normalize title sort field -->
            <om:field name="title_sort" fusion-name="title_sort">
                <om:change>
                    <om:response type="normalizer">
                        <trim>true</trim>
                        <to-lower-case>true</to-lower-case>
                        <start-chars-to-del>&#32;&#160;."-[(</start-chars-to-del>
                    </om:response>
                </om:change>
                <om:change><om:query /></om:change>
            </om:field>

            <om:field fusion-name="solr-server">
                <om:add>
                    <om:response target="facet" type="static-value">
                        <value>UBL4</value>
                    </om:response>
                    <om:response target="facet" type="set-doc-count">
                        <total-found-nr />
                    </om:response>
                </om:add>
                <om:drop><om:query /></om:drop>
            </om:field>

            <om:post-processor>
                <om:query type="send-if-fq-eq">
                    <fusion-name>solr-server</fusion-name>
                    <fusion-value>UBL4</fusion-value>
                </om:query>
                <om:query type="filter-empty-fq">
                    <ignore-fusion-name>solr-server</ignore-fusion-name>
                    <ignore-fusion-name>authorized_mode</ignore-fusion-name>
                </om:query>
            </om:post-processor>

        </om:solr-server>

    </om:solr-servers>
</om:core>
